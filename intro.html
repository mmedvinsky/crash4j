<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Crash4j : Fault tolerance framework for JVM runtimes " />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Crash4j</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mmedvinsky/crash4j">View on GitHub</a>

          <h1 id="project_title">CRASH4J</h1>
          <h2 id="project_tagline">Fault tolerance testing framework for JVM runtimes </h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mmedvinsky/crash4j/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mmedvinsky/crash4j/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    <table id="project_tagline">
      <tr>
      <td><a href="index.html">Home</a></td>        
      <td><a href="intro.html">Introduction</a></td>        
      <td><a href="starting.html">Getting Started</a></td>        
      <td><a href="uguide.html">User Guide</a></td>        
      </tr>
    </table>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
       <h3>Introduction</h3>
       Crash4j is an engine and a platform used to perform fault tolerance testing .  
       The importance of fault-tolerance testing becomes more prominent as complexity of your production environment grows.  
       As we have seen almost exponential growth in system layers and their inter-dependencies the need to understand 
       the fault bearing capabilities of each individual system participant is very important. 
       <p/>
       All systems can be classified into 3 main categories, as they are measured for fault tolerance:
       <table>
         <tr><td>Unrecoverable</td><td>Recoverable</td><td>Fault Tolerant</td></tr>    
         <tr><td>The system experiences a period of instability and is unable to recover from it. 
Recover involves, restarting, reconfiguring or fixing the system
</td><td>The system experiences a period of instability and is able to recover from it and continue operating with the same SLA as before the instability took place</td>
<td>The system experiences instability but is able to carry on with operations in acceptable way, despite instability.</td></tr>
       </table>
Most of the systems in the world are resident of the Recoverable category.  There are very few systems or applications for which it is ok to go under after a period of instability and require manual intervention in order to be operational again. Even fewer are the systems that are redundant enough or fault tolerant enough to leave through instabilities and remain unaffected by the event.   The very few examples of fully fault tolerant systems are limited to military, airplane and medical industries.

Crash4j system allows you to integrate fault tolerant testing very early in the development cycle and continue with it all the way to pre-production testing.

In order to integrate the fault tolerant testing into you development practices the crash4j engine provides integration with the JUnit 4 testing framework as well as providing a runtime agent to effect workloads during a more formal tests.
       
       <h3>What elements are included?</h3>
       The crash4j runtime is able to recognize the following elements of your workload environment.
       <ol>
         <li>NETWORK</li>
         <li>FILE SYSTEM</li>
         <li>DATABASES (RDBMS)</li>
         <li>SERVICES (HTTP, FTP, SMTP)</li>         
       </ol>
       
       These are currently implemented elements that are available from crash4j product today.  More will be coming in the future.
       <h3>How is environment represented?</h3>
       The environment is discovered from the operational behavior of you workload.  Once an environment resource is discovered it is represented in a form of a unique complex name.  For example a network resource, connecting from localhost to port 3306 over tcp will be represented as follows:
       
       <table><tr><td><i>net</i>:port=3306,parent=db@6b2dc21d@5e4c5524,host=localhost,secure=false,server=false,protocol=tcp</td></tr></tr></table>
       The general format chosen to encode the resources is similar to Java JMX ObjectName, chosen for its extensibility and simplicity:

      <table><tr><td>[ResourceType][:]( [name]=[value] )([,] [name]=[value] )*</td></tr></tr></table>


Examining, the network resource we can see a number of attributes, for example “port” attribute, describes remote port of the identified stream, “parent”, if present, shows a parent resource, under whose context this resource is operating, “host” is an address of the network connection, “server” marks this to be a client/server socket and finally “protocol” attribute identifies the network protocol to be tcp.

In addition to the resource identifiers, each resource types (com.crash4j.engine.types.ResourceTypes) can perform a number of actions, described by action classes.
<table>
<tr><td>Resource Types</td><td>Symbol</td><td>Resource Class</td></tr>
<tr><td>Network</td><td>net</td><td>IO</td></tr>
<tr><td>File System</td><td>fsys</td><td>IO,FILESYSTEM</td></tr>
<tr><td>RDBMS</td><td>db</td><td>SQL</td></tr>
<tr><td>HTTPk</td><td>http</td><td>IO, HTTP</td></tr> 
</table>
 
 <h3>Resources</h3>
 
 <h4>Network Resource</h4>
 Network resource describes a network stream, opened through various means by java program in order to communicate with a remote server.  The current implementation is able to recognize an describe TCP, UDP connections, address resolution calls, operations performed on the open socket, such as setting of options, closing, etc.  Crash4j engine is also able to work with both blocking as well as non-blocking IO.  What that really means is that is your workload is using a java.net.Socket to talk to host1, port1 or is using java.nio.SocketChannel to talk to host1, port1 – it will be described as a single remote resource, identified by host1, port1 and can be effected as such.  In addition the crash4j engine is able to detected ssl and server sockets.  
 Here are all of the attributes that can be present in a Network Resource
 
<table>
<tr><td>Attribute</td><td>Required</td><td>Description</td></tr>
<tr><td>Port</td><td>yes</td><td>Describes designated remote port, to which this socket is connected</td></tr>
<tr><td>Host</td><td>yes</td><td>Describes designated remote host to which this socket is connected.  The host will commonly be described by name but if unavailable the address will apply</td></tr>
<tr><td>Secure</td><td>No</td><td>If not present a non-secure socket is assumed.  If present the socket is communicating over SSL.</td></tr>
<tr><td>Server</td><td>No</td><td>IO, HTTP</td></tr>
<tr><td>Protocol</td><td>No</td><td>IO, HTTP</td></tr>
</table>
 <i>For example:</i><p/>

 <table>
 <tr><td>net:port=6553,host=localhost,secure=false,server=false,protocol=tcp</td></tr> 
 <tr><td>Describes a network resource in the environment of you runtime that is connected to remote port 6553 at localhost, its not secure and is communicating using tcp.</td></tr>

 <tr><td>net:port=6553,host=0.0.0.0,secure=false,server=true,protocol=tcp</td></tr> 
 <tr><td>Describes a server socket that is connected to the remote port 6553 on local interface 0.0.0.0, its not secure and is using tcp.</td></tr>
 
</table>

As was described before, every resource can perform a set of actions.  As the network resource belongs to the IO action class and to NETWORK action class it can perform all of the IO actions. See Appendix A.

  <h4>File System Resource</h4>

File system resource describes streams that are accessing underlying file systems for a variety of reasons.  The structure of the file system resource can be of a few types, depending on configuration and/or circumstances.
<ol>
<ul>If configured, only mount points are watched and aggregated and in this case the resource data and simulation will be aggregated at mount points., no matter how many files have being accessed.  Ex, :fsys:resource=/var/folders</ul>
<ul>By default the system aggregates at the directory level, since this is the most usful file system point of contention and function, for example: fsys:resource=/var/folders/a/b/cs</ul>
<ul>If configured the engine can aggregate at file level as well fsys:resource=/var/folders/T/testChannelFile.txts</ul>
<ul>The filesystem resource also encompasses standard stream handling. In this case the resource structure contains, stdin, stdout, stderr  identifiers.  For example: fsys:resource=stdout, fsys:resource=stderr, fsys:resource=stdins</ul>
<ul>Lastly, there are rare occasions when crash4j engine is not able to recognize the original source of the stream of file system activity  and the only  item available is a raw file handle, as presented by java., i.e. fsys:resource=java.io.FileDescriptor@684ee543s</ul>
</ol>

File system resource belongs to 2 action class groups – IO and FILESYSTEM.  Details of these actions you can find in Appendix A.

<h4>RDBMS Resource</h4>

RDBMS resource describes access of the current runtime to the relational database system.  The RDBM resource recognizes the presence and communications of JDBC API to the underlying driver and allows you to inject behavior and capture monitoring information based on actions performed by the statement in flight.  In the current version the action classes are aggregated around the SQL commands and include the full spectrum of SQL 2.  We are working on a mode, where a resource is created for each set of tables that a query is executing.  This will allow for much deeper scenario simulation with standard RDBMS systems.
As an example, here is a db resource detected from the use of MYSQL database.
db:url=jdbc@mysql@//localhost/plastiq_trans,parent=db@415a9b89@5e4c5524,driver=MySQL-AB JDBC Driver,vendor=MySQL
 
<h4>HTTP Resource</h4>
A very important resource is an HTTP resource.   The need to recognize HTTP traffic, above the regular network streams allows us to include all of the HTTP bearing services into the understood and controllable environment.   In the recent years HTTP and HTTPS has become a standard protocol for most of the inter-machine communications, due to its wide adoption over the public world wide web.
When detected, an HTTP resource is created and is unique based on host, port and URL used.  Since this action class is one of HTTP, its stands to reason that action classes are also of the same type and therefore are comprised of methods allowed by the protocol.  
For example, here is a captured HTTP resource, that is communicating to google.com
http:port=80,parent=net@2bb6fd5c@50,host=www.google.com,path=/
 
<h4>Action Types</>

<h5>IO Action Class</h5>
<table>
<tr><td>Action</td>  <td>Description</td></tr>
<tr><td>io:init</td>	<td>Initializes the resource but does not open it yet
<tr><td>io:bind</td>	<td>Binds resource 
<tr><td>io:open</td>	<td>Opens connection to a remote stream handler
<tr><td>io:close</td>	<td>Closes the open and active connection
<tr><td>io:destroy</td>	<td>Destroys the resource and all of hi operational dependancies
<tr><td>io:read</td>	<td>Performs a single read on the sream
<tr><td>io:write</td>	<td>Performs a single write operation on the resource
<tr><td>io:check</td>	<td>Check the state and semantics of the stream
<table>
	

<h5>NETWORK Action class</h5>
Action	Description
network:addressresolution	Calls to address resolution 
network:queryinterface	Checking the local network interface
network:getinfo	General informational actions.
	
   

File System Action class
Action	Description
filesystem:create	Creates a file 
filesystem:rename	Rename the file
filesystem:delete	General informational actions.
filesystem:chagestate	Change the state of the underlying file
filesystem:checkpermission	Check permission
filesystem:getinfo	Get general information
filesystem:exist	Check if the file exists

SQL Action class
sql:SELECT,sql:INSERT,sql:UPDATE,sql:DELETE,sql:USE,sql:GRANT,sql:CREATE,sql:ALTER,sql:DROP,sql:ANALYZE,sql:ASSOCIATE,sql:AUDIT,sql:COMMENT,sql:DISASSOCIATE,sql:FLASHBACK,sql:NOAUDIT,sql:PURGE,sql:RENAME,sql:REVOKE,sql:TRUNCATE,sql:UNDROP,sql:CALL,sql:EXPLAIN,sql:LOCK,sql:MERGE,sql:COMMIT,sql:ROLLBACK,sql:SAVEPOINT,sql:CLOSE,sql:EXECUTE,sql:SET,sql:SQLCOMMAND;


HTTP Action class
Action	Description
http:get	HTTP GET
Fhttp:post	HTTP POST
….	See HTTP RFC for complete list


      </section>
    </div>
    
    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Crash4j maintained by <a href="https://github.com/mmedvinsky">mmedvinsky</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
